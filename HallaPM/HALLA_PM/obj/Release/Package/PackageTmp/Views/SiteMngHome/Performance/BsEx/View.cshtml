@using HALLA_PM.Models;
@using HALLA_PM.Util;
@using HALLA_PM.Core;
@{
    ViewBag.Title = "View";
    Layout = "~/Views/Shared/_LayoutSiteMng.cshtml";
    PmBsEx pmBs = Model.pmBs;
    OrgCompany orgCompanyName = Model.orgCompanyName;

    PmBsBsheetEx lastPmBsheetEx = Model.lastPmBsheetEx;
    PlanYearBsBsheetEx thisPnBsheetEx = Model.thisPnBsheetEx;
    PmBsBsheetEx thisPmBsheetEx = Model.thisPmBsheetEx;

    PmBsRoicEx lastPmRoicEx = Model.lastPmRoicEx;
    PlanYearBsRoicEx thisPnRoicEx = Model.thisPnRoicEx;
    PmBsRoicEx thisPmRoicEx = Model.thisPmRoicEx;

    PmBsWCapitalEx lastPmWCapitalEx = Model.lastPmWCapitalEx;
    PlanYearBsWCapitalEx thisPnWCapitalEx = Model.thisPnWCapitalEx;
    PmBsWCapitalEx thisPmWCapitalEx = Model.thisPmWCapitalEx;

    PmBsWCapitalRegEx lastPmWCapitalRegEx = Model.lastPmWCapitalRegEx;
    PlanYearBsWCapitalRegEx thisPnWCapitalRegEx = Model.thisPnWCapitalRegEx;
    PmBsWCapitalRegEx thisPmWCapitalRegEx = Model.thisPmWCapitalRegEx;

    PmBsSummaryEx lastPmSummaryEx = Model.lastPmSummaryEx;
    PlanYearBsSummaryEx thisPnSummaryEx = Model.thisPnSummaryEx;
    PmBsSummaryEx thisPmSummaryEx = Model.thisPmSummaryEx;

    if (lastPmBsheetEx == null) { lastPmBsheetEx = new PmBsBsheetEx(); }
    if (thisPnBsheetEx == null) { thisPnBsheetEx = new PlanYearBsBsheetEx(); }
    if (lastPmRoicEx == null) { lastPmRoicEx = new PmBsRoicEx(); }
    if (thisPnRoicEx == null) { thisPnRoicEx = new PlanYearBsRoicEx(); }
    if (lastPmWCapitalEx == null) { lastPmWCapitalEx = new PmBsWCapitalEx(); }
    if (thisPnWCapitalEx == null) { thisPnWCapitalEx = new PlanYearBsWCapitalEx(); }
    if (lastPmWCapitalRegEx == null) { lastPmWCapitalRegEx = new PmBsWCapitalRegEx(); }
    if (thisPnWCapitalRegEx == null) { thisPnWCapitalRegEx = new PlanYearBsWCapitalRegEx(); }
    if (lastPmSummaryEx == null) { lastPmSummaryEx = new PmBsSummaryEx(); }
    if (thisPnSummaryEx == null) { thisPnSummaryEx = new PlanYearBsSummaryEx(); }
    Search search = ViewBag.Search;
    decimal dMonth = Convert.ToDecimal(pmBs.Monthly);
}

<div id="container">
    <div class="location">
        <span class="home"><i class="fa fa-home"></i></span>
        <span>경영실적</span>
        <strong>중기BS - (주)한라 별도</strong>
    </div>

    <form name="frmMain" id="frmMain" method="post" enctype="multipart/form-data">
        <input type="hidden" name="Seq" value="@pmBs.Seq" />
        <input type="hidden" name="OrgCompanySeq" value="@pmBs.OrgCompanySeq" />
        <input type="hidden" name="RegistStatus" value="@pmBs.RegistStatus" />
        <input type="hidden" name="afterRegistStatus" value="" />
        <input type="hidden" name="message" value="" />
        <input type="hidden" name="PageIndex" value="@(search.PageIndex)" />
        <input type="hidden" name="searchYear" value="@(search.searchYear)" />
        <input type="hidden" name="searchMonth" value="@(search.searchMonth)" />
        <div class="con_box search">
            <h3 class="mt0">BS 등록</h3>
            <div class="bg_gray">
                <i class="fa fa-info-circle" aria-hidden="true"></i> 계산하기를 클릭하시면 비율, 합계 등을 미리 확인하실 수 있습니다.<br />
                <i class="fa fa-info-circle" aria-hidden="true"></i> 승인요청, 승인 클릭 시 수정이 불가능하니 신중히 작성해주세요.
            </div>
        </div>
        <!--// con_box -->

        <div class="con_box">
            <table class="tbl th_ver ta_left">
                <caption></caption>
                <colgroup>
                    <col width="15%" />
                    <col width="/" />
                </colgroup>
                <tbody>
                    <tr>
                        <th scope="row">등록연월</th>
                        <td>@(pmBs.BsYear)년 @(pmBs.Monthly)월</td>
                    </tr>
                    <tr>
                        <th scope="row">회사</th>
                        <td>
                            <table class="tbl2">
                                <tr>
                                    <td>@orgCompanyName.UnionName > @orgCompanyName.CompanyName</td>
                                    <td class="ta_right">@Define.REGIST_STATUS.GetValue(pmBs.RegistStatus)</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
            <!--// tbl th_ver -->

            <h3>B/Sheet</h3>
            <table class="tbl th_hor" border="0" cellpadding="0" cellspacing="0">
                <caption></caption>
                <colgroup>
                    <col width="7%" />
                    <col width="7%" />
                    <col width="7%" />
                    <col width="/" />
                </colgroup>
                <thead>
                    <tr>
                        <th scope="col" colspan="3">구분</th>
                        <th scope="col">총자산<br />(유동자산)</th>
                        <th scope="col">총부채<br />(유동부채)</th>
                        <th scope="col">총자본</th>
                        <th scope="col">현금</th>
                        <th scope="col">차입금</th>
                        <th scope="col">부채비율</th>
                        <th scope="col">유동비율</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>@*2018.12.19 유동 값 이외에는 요약에서 가져오게 변경(전년실적)*@
                        <th scope="row">@(Convert.ToInt32(pmBs.BsYear) - 1)년</th>
                        <th scope="row" colspan="2">실적</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Assets, 2)<br />(@WebUtil.NCommaRound(lastPmBsheetEx.CurrentAssets, 2))</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Liabilities, 2)<br />(@WebUtil.NCommaRound(lastPmBsheetEx.CurrentLiabilities, 2))</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Capital, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Cash, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Loan, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.LiabilitiesRate = WebUtil.NumberRound(lastPmSummaryEx.Liabilities, lastPmSummaryEx.Capital, 100, 2), 2)%</td>
                        <td>@WebUtil.NCommaRound(lastPmBsheetEx.CurrentRate = WebUtil.NumberRound(lastPmBsheetEx.CurrentAssets, lastPmBsheetEx.CurrentLiabilities, 100, 2), 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row" rowspan="4">@pmBs.BsYear</th>
                        <th scope="row" rowspan="4">[@pmBs.Monthly 월]</th>
                        <th scope="row">계획</th>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.Assets, 2)<br />(@WebUtil.NCommaRound(thisPnBsheetEx.CurrentAssets, 2))</td>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.Liabilities, 2)<br />(@WebUtil.NCommaRound(thisPnBsheetEx.CurrentLiabilities, 2))</td>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.Capital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.Cash, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.Loan, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.LiabilitiesRate = WebUtil.NumberRound(thisPnBsheetEx.Liabilities, thisPnBsheetEx.Capital, 100, 2), 2)%</td>
                        <td>@WebUtil.NCommaRound(thisPnBsheetEx.CurrentRate = WebUtil.NumberRound(thisPnBsheetEx.CurrentAssets, thisPnBsheetEx.CurrentLiabilities, 100, 2), 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row">
                            실적
                        </th>
                        <td>@WebUtil.NCommaRound(thisPmBsheetEx.Assets, 2)<br /><br />(@WebUtil.NCommaRound(thisPmBsheetEx.CurrentAssets, 2))</td>
                        <td>@WebUtil.NCommaRound(thisPmBsheetEx.Liabilities, 2)<br /><br />(@WebUtil.NCommaRound(thisPmBsheetEx.CurrentLiabilities, 2))</td>
                        <td>@WebUtil.NCommaRound(thisPmBsheetEx.Capital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmBsheetEx.Cash, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmBsheetEx.Loan, 2)</td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmBsheetEx.LiabilitiesRate = WebUtil.NumberRound(thisPmBsheetEx.Liabilities, thisPmBsheetEx.Capital, 100, 2), 2)%</p>
                        </td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmBsheetEx.CurrentRate = WebUtil.NumberRound(thisPmBsheetEx.CurrentAssets, thisPmBsheetEx.CurrentLiabilities, 100, 2), 2) %</p>
                        </td>
                    </tr>
                    <tr>
                        <th scope="row">계획대비</th>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Assets - thisPnBsheetEx.Assets, 2)<br />(@WebUtil.NCommaRound(thisPmBsheetEx.CurrentAssets - thisPnBsheetEx.CurrentAssets), 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Liabilities - thisPnBsheetEx.Liabilities, 2)<br />(@WebUtil.NCommaRound(thisPmBsheetEx.CurrentLiabilities - thisPnBsheetEx.CurrentLiabilities), 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Capital - thisPnBsheetEx.Capital, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Cash - thisPnBsheetEx.Cash, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Loan - thisPnBsheetEx.Loan, 2)</td>
                        @*<td class="bg_blue">@(WebUtil.NumberRound(thisPmBsheetEx.Liabilities - thisPnBsheetEx.Liabilities, thisPmBsheetEx.Capital - thisPnBsheetEx.Capital, 100, 2)) %</td>
                        <td class="bg_blue">@(WebUtil.NumberRound(thisPmBsheetEx.CurrentAssets - thisPnBsheetEx.CurrentAssets, thisPmBsheetEx.CurrentLiabilities - thisPnBsheetEx.CurrentLiabilities, 100, 2))%</td>*@
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.LiabilitiesRate - thisPnBsheetEx.LiabilitiesRate, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.CurrentRate - thisPnBsheetEx.CurrentRate, 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row">전년대비</th>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Assets - lastPmSummaryEx.Assets, 2)<br />(@WebUtil.NCommaRound(thisPmBsheetEx.CurrentAssets - lastPmBsheetEx.CurrentAssets), 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Liabilities - lastPmSummaryEx.Liabilities, 2)<br />(@WebUtil.NCommaRound(thisPmBsheetEx.CurrentLiabilities - lastPmBsheetEx.CurrentLiabilities), 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Capital - lastPmSummaryEx.Capital, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Cash - lastPmSummaryEx.Cash, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.Loan - lastPmSummaryEx.Loan, 2)</td>
                        @*<td class="bg_blue">@(WebUtil.NumberRound(thisPmBsheetEx.Liabilities - lastPmBsheetEx.Liabilities, thisPmBsheetEx.Capital - lastPmBsheetEx.Capital, 100, 2)) %</td>
                        <td class="bg_blue">@(WebUtil.NumberRound(thisPmBsheetEx.CurrentAssets - lastPmBsheetEx.CurrentAssets, thisPmBsheetEx.CurrentLiabilities - lastPmBsheetEx.CurrentLiabilities, 100, 2))%</td>*@
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.LiabilitiesRate - lastPmSummaryEx.LiabilitiesRate, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmBsheetEx.CurrentRate - lastPmBsheetEx.CurrentRate, 2)%</td>
                    </tr>
                </tbody>
            </table>
            <!--//tbl th_ver-->

            <h3>ROIC</h3>
            <p class="caption"><span>(단위 : 억원,%)</span></p>
            <table class="tbl th_hor" border="0" cellpadding="0" cellspacing="0">
                <caption></caption>
                <colgroup>
                    <col width="7%" />
                    <col width="7%" />
                    <col width="7%" />
                    <col width="/" />
                </colgroup>
                <thead>
                    <tr>
                        <th scope="col" colspan="3">구분</th>
                        <th scope="col">세후 영업이익</th>
                        <th scope="col">투하자본</th>
                        <th scope="col">ROIC</th>
                        <th scope="col">ROIC 연환산</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>@*2018.12.19 유동 값 이외에는 요약에서 가져오게 변경(전년실적)*@
                        <th scope="row">@(Convert.ToInt32(pmBs.BsYear) - 1)년</th>
                        <th scope="row" colspan="2">실적</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.AfterTaxOperationProfit, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.PainInCapital, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Roic = WebUtil.NumberRound(lastPmSummaryEx.AfterTaxOperationProfit, lastPmSummaryEx.PainInCapital, 100, 2), 2) %</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.RoicYear = WebUtil.NumberRound(lastPmSummaryEx.AfterTaxOperationProfit, lastPmSummaryEx.PainInCapital, 100, 2), 2) %</td>
                    </tr>
                    <tr>
                        <th scope="row" rowspan="4">@pmBs.BsYear</th>
                        <th scope="row" rowspan="4">[@pmBs.Monthly 월]</th>
                        <th scope="row">계획</th>
                        <td>@WebUtil.NCommaRound(thisPnRoicEx.AfterTaxOperationProfit, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnRoicEx.PainInCapital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnRoicEx.Roic = WebUtil.NumberRound(thisPnRoicEx.AfterTaxOperationProfit, thisPnRoicEx.PainInCapital, 100, 2), 2) %</td>
                        <td>@WebUtil.NCommaRound(thisPnRoicEx.RoicYear = WebUtil.NewRoic(WebUtil.NumberRound(thisPnRoicEx.AfterTaxOperationProfit, thisPnRoicEx.PainInCapital, 100, 8), dMonth), 2) %</td>
                    </tr>
                    <tr>
                        <th scope="row">
                            실적
                        </th>
                        <td>@WebUtil.NCommaRound(thisPmRoicEx.AfterTaxOperationProfit, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmRoicEx.PainInCapital, 2)</td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmRoicEx.Roic = WebUtil.NumberRound(thisPmRoicEx.AfterTaxOperationProfit, thisPmRoicEx.PainInCapital, 100, 2), 2) %</p>
                        </td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmRoicEx.RoicYear = WebUtil.NewRoic(WebUtil.NumberRound(thisPmRoicEx.AfterTaxOperationProfit, thisPmRoicEx.PainInCapital, 100, 8), dMonth), 2) %</p>
                        </td>
                    </tr>
                    @{
                        PmBsRoic pnD = new PmBsRoic();
                        pnD.AfterTaxOperationProfit = thisPmRoicEx.AfterTaxOperationProfit - thisPnRoicEx.AfterTaxOperationProfit;
                        pnD.PainInCapital = thisPmRoicEx.PainInCapital - thisPnRoicEx.PainInCapital;
                        pnD.Roic = WebUtil.NumberRound(pnD.AfterTaxOperationProfit, pnD.PainInCapital, 100, 0);
                        PmBsRoic pmD = new PmBsRoic();
                        pmD.AfterTaxOperationProfit = thisPmRoicEx.AfterTaxOperationProfit - lastPmSummaryEx.AfterTaxOperationProfit;
                        pmD.PainInCapital = thisPmRoicEx.PainInCapital - lastPmSummaryEx.PainInCapital;
                        pmD.Roic = WebUtil.NumberRound(pmD.AfterTaxOperationProfit, pmD.PainInCapital, 100, 0);
                    }
                    <tr>
                        <th scope="row">계획대비</th>
                        <td class="bg_blue">@WebUtil.NCommaRound(pnD.AfterTaxOperationProfit, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(pnD.PainInCapital, 2)</td>
                        @*<td class="bg_blue">@(pnD.Roic)%</td>*@
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmRoicEx.Roic - thisPnRoicEx.Roic, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmRoicEx.RoicYear - thisPnRoicEx.RoicYear, 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row">전년대비</th>
                        <td class="bg_blue">@WebUtil.NCommaRound(pmD.AfterTaxOperationProfit, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(pmD.PainInCapital, 2)</td>
                        <td class="bg_blue">@*@(pmD.Roic)%*@</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmRoicEx.Roic - lastPmSummaryEx.Roic, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmRoicEx.RoicYear - lastPmSummaryEx.RoicYear, 2)%</td>
                    </tr>
                </tbody>
            </table>
            <!--//tbl th_ver-->

            <h3>W/Capital</h3>
            <p class="caption"><span>(단위 : 억원)</span></p>
            <table class="tbl th_ver">
                <caption></caption>
                <colgroup>
                    <col width="12%" />
                    <col width="22%" />
                    <col width="12%" />
                    <col width="21%" />
                    <col width="12%" />
                    <col width="21%" />
                </colgroup>
                <tbody>
                    <tr>
                        <th scope="row">연간 매출액</th>
                        <td>@WebUtil.NCommaRound(thisPmWCapitalEx.AnnualSales, 2)</td>
                        <th scope="row">연간매출원가(AP)</th>
                        <td>@WebUtil.NCommaRound(thisPmWCapitalEx.AnnualSalesCost, 2)</td>
                        <th scope="row">연간매출원가(Inv)</th>
                        <td>@WebUtil.NCommaRound(thisPmWCapitalEx.InventoryCost, 2)</td>
                    </tr>
                </tbody>
            </table>
            <!--// tbl th_ver -->

            @*<div class="btn_area">
                <a href="javascript:onSalesAccountAction();" class="btn full_green">매출액 등록</a>
            </div>*@
            <!--//btn_area-->

            <table class="tbl th_hor mt40" border="0" cellpadding="0" cellspacing="0">
                <caption></caption>
                <colgroup>
                    <col width="7%" />
                    <col width="7%" />
                    <col width="7%" />
                    <col width="/" />
                </colgroup>
                <thead>
                    <tr>
                        <th scope="col" colspan="3">구분</th>
                        <th scope="col">A/R</th>
                        <th scope="col">AR T/O Days</th>
                        <th scope="col">A/P </th>
                        <th scope="col">AP T/O Days</th>
                        <th scope="col">Inventory</th>
                        <th scope="col">Inventory T/O Days</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>@*2018.12.19 유동 값 이외에는 요약에서 가져오게 변경(전년실적)*@
                        <th scope="row">@(Convert.ToInt32(pmBs.BsYear) - 1)년</th>
                        <th scope="row" colspan="2">실적</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Ar, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.ArToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Ap, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.ApToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Inventory, 2)</td>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.InventoryToDays, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row" rowspan="4">@pmBs.BsYear</th>
                        <th scope="row" rowspan="4">[@pmBs.Monthly 월]</th>
                        <th scope="row">계획</th>
                        <td>@WebUtil.NCommaRound(thisPnWCapitalRegEx.Ar, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnWCapitalRegEx.ArToDays = WebUtil.NumberRound(thisPnWCapitalRegEx.Ar, thisPnWCapitalEx.AnnualSales, 365, 2), 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnWCapitalRegEx.Ap, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnWCapitalRegEx.ApToDays = WebUtil.NumberRound(thisPnWCapitalRegEx.Ap, thisPnWCapitalEx.AnnualSalesCost, 365, 2), 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnWCapitalRegEx.Inventory, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnWCapitalRegEx.InventoryToDays = WebUtil.NumberRound(thisPnWCapitalRegEx.Inventory, thisPnWCapitalEx.InventoryCost, 365, 2), 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">
                            실적
                        </th>
                        <td>@WebUtil.NCommaRound(thisPmWCapitalRegEx.Ar, 2)</td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmWCapitalRegEx.ArToDays = WebUtil.NumberRound(thisPmWCapitalRegEx.Ar, thisPmWCapitalEx.AnnualSales, 365, 2), 2)</p>
                        </td>
                        <td>@WebUtil.NCommaRound(thisPmWCapitalRegEx.Ap, 2)</td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmWCapitalRegEx.ApToDays = WebUtil.NumberRound(thisPmWCapitalRegEx.Ap, thisPmWCapitalEx.AnnualSalesCost, 365, 2), 2)</p>
                        </td>
                        <td>@WebUtil.NCommaRound(thisPmWCapitalRegEx.Inventory, 2)</td>
                        <td class="bg_blue">
                            <p>@WebUtil.NCommaRound(thisPmWCapitalRegEx.InventoryToDays = WebUtil.NumberRound(thisPmWCapitalRegEx.Inventory, thisPmWCapitalEx.InventoryCost, 365, 2), 2)</p>
                        </td>
                    </tr>
                    <tr>
                        <th scope="row">계획대비</th>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.Ar - thisPnWCapitalRegEx.Ar, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.ArToDays - thisPnWCapitalRegEx.ArToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.Ap - thisPnWCapitalRegEx.Ap, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.ApToDays - thisPnWCapitalRegEx.ApToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.Inventory - thisPnWCapitalRegEx.Inventory, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.InventoryToDays - thisPnWCapitalRegEx.InventoryToDays, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">전년대비</th>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.Ar - lastPmSummaryEx.Ar, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.ArToDays - lastPmSummaryEx.ArToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.Ap - lastPmSummaryEx.Ap, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.ApToDays - lastPmSummaryEx.ApToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.Inventory - lastPmSummaryEx.Inventory, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmWCapitalRegEx.InventoryToDays - lastPmSummaryEx.InventoryToDays, 2)</td>
                    </tr>
                </tbody>
            </table>

            @*<div class="btn_area bd_btm">
                <a href="javascript: onReset();" class="btn full_green">초기화</a>
                <a href="javascript: onCalculationAction();" class="btn full_green">계산하기</a>
            </div>*@

            <h3>[@pmBs.Monthly 월] BS 관리지표 (누계)</h3>
            <p class="caption"><span>(단위 : 억원,%)</span></p>
            <table class="tbl th_hor" border="0" cellpadding="0" cellspacing="0">
                <caption></caption>
                <colgroup>
                    <col width="7%" />
                    <col width="10%" />
                    <col width="/" />
                </colgroup>
                <thead>
                    <tr>
                        <th scope="col" colspan="2" rowspan="3">구분</th>
                        <th scope="col">@(Convert.ToInt32(pmBs.BsYear) - 1)년</th>
                        <th scope="col" colspan="4">@pmBs.BsYear 년</th>
                    </tr>
                    <tr>
                        <th scope="col">기말</th>
                        <th scope="col" colspan="4">@pmBs.Monthly 월 누계</th>
                    </tr>
                    <tr>
                        <th scope="col">실적</th>
                        <th scope="col">계획</th>
                        <th scope="col">실적</th>
                        <th scope="col">계획대비</th>
                        <th scope="col">전년대비</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row" rowspan="6">B/S</th>
                        <th scope="row">
                            총자산
                        </th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Assets, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Assets, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Assets, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Assets - thisPnSummaryEx.Assets, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Assets - lastPmSummaryEx.Assets, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">총부채</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Liabilities, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Liabilities, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Liabilities, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Liabilities - thisPnSummaryEx.Liabilities, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Liabilities - lastPmSummaryEx.Liabilities, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">총자본</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Capital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Capital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Capital, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Capital - thisPnSummaryEx.Capital, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Capital - lastPmSummaryEx.Capital, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">현금</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Cash, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Cash, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Cash, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Cash - thisPnSummaryEx.Cash, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Cash - lastPmSummaryEx.Cash, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">차입금</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Loan, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Loan, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Loan, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Loan - thisPnSummaryEx.Loan, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Loan - lastPmSummaryEx.Loan, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">부채비율</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.LiabilitiesRate = WebUtil.NumberRound(lastPmSummaryEx.Liabilities, lastPmSummaryEx.Capital, 100, 2), 2)%</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.LiabilitiesRate = WebUtil.NumberRound(thisPnSummaryEx.Liabilities, thisPnSummaryEx.Capital, 100, 2), 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.LiabilitiesRate = WebUtil.NumberRound(thisPmSummaryEx.Liabilities, thisPmSummaryEx.Capital, 100, 2), 2)%</td>
                        @*<td class="bg_blue">@(WebUtil.NumberRound(thisPmSummaryEx.Liabilities - thisPnSummaryEx.Liabilities, thisPmSummaryEx.Capital - thisPnSummaryEx.Capital, 100, 2))%</td>
                        <td class="bg_blue">@(WebUtil.NumberRound(thisPmSummaryEx.Liabilities - lastPmSummaryEx.Liabilities, thisPmSummaryEx.Capital - lastPmSummaryEx.Capital, 100, 2))%</td>*@
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.LiabilitiesRate - thisPnSummaryEx.LiabilitiesRate, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.LiabilitiesRate - lastPmSummaryEx.LiabilitiesRate, 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row" rowspan="4">ROIC</th>
                        <th scope="row">세후 영업이익</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.AfterTaxOperationProfit, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.AfterTaxOperationProfit, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.AfterTaxOperationProfit, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.AfterTaxOperationProfit - thisPnSummaryEx.AfterTaxOperationProfit, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.AfterTaxOperationProfit - lastPmSummaryEx.AfterTaxOperationProfit, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">투하자본</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.PainInCapital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.PainInCapital, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.PainInCapital, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.PainInCapital - thisPnSummaryEx.PainInCapital, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.PainInCapital - lastPmSummaryEx.PainInCapital, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">ROIC</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Roic = WebUtil.NumberRound(lastPmSummaryEx.AfterTaxOperationProfit, lastPmSummaryEx.PainInCapital, 100, 2), 2)%</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Roic = WebUtil.NumberRound(thisPnSummaryEx.AfterTaxOperationProfit, thisPnSummaryEx.PainInCapital, 100, 2), 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Roic = WebUtil.NumberRound(thisPmSummaryEx.AfterTaxOperationProfit, thisPmSummaryEx.PainInCapital, 100, 2), 2)%</td>
                        @*<td class="bg_blue">@(WebUtil.NumberRound(thisPmSummaryEx.AfterTaxOperationProfit - thisPnSummaryEx.AfterTaxOperationProfit, thisPmSummaryEx.PainInCapital - thisPnSummaryEx.PainInCapital, 100, 2))</td>
                        <td class="bg_blue">@(WebUtil.NumberRound(thisPmSummaryEx.AfterTaxOperationProfit - lastPmSummaryEx.AfterTaxOperationProfit, thisPmSummaryEx.PainInCapital - lastPmSummaryEx.PainInCapital, 100, 2))</td>*@
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Roic - thisPnSummaryEx.Roic, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Roic - lastPmSummaryEx.Roic, 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row">ROIC 연환산</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.RoicYear = WebUtil.NumberRound(lastPmSummaryEx.AfterTaxOperationProfit, lastPmSummaryEx.PainInCapital, 100, 2), 2)%</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.RoicYear = WebUtil.NewRoic(WebUtil.NumberRound(thisPnSummaryEx.AfterTaxOperationProfit, thisPnSummaryEx.PainInCapital, 100, 8), dMonth), 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.RoicYear = WebUtil.NewRoic(WebUtil.NumberRound(thisPmSummaryEx.AfterTaxOperationProfit, thisPmSummaryEx.PainInCapital, 100, 8), dMonth) ,2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.RoicYear - thisPnSummaryEx.RoicYear, 2)%</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.RoicYear - lastPmSummaryEx.RoicYear, 2)%</td>
                    </tr>
                    <tr>
                        <th scope="row" rowspan="6">W/C</th>
                        <th scope="row">A/R</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Ar, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Ar, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Ar, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Ar - thisPnSummaryEx.Ar, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Ar - lastPmSummaryEx.Ar, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">T/O days</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.ArToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.ArToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.ArToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.ArToDays - thisPnSummaryEx.ArToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.ArToDays - lastPmSummaryEx.ArToDays, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">A/P</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Ap, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Ap, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Ap, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Ap - thisPnSummaryEx.Ap, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Ap - lastPmSummaryEx.Ap, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">T/O days</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.ApToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.ApToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.ApToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.ApToDays - thisPnSummaryEx.ApToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.ApToDays - lastPmSummaryEx.ApToDays, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">Inventory</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.Inventory, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.Inventory, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.Inventory, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Inventory - thisPnSummaryEx.Inventory, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.Inventory - lastPmSummaryEx.Inventory, 2)</td>
                    </tr>
                    <tr>
                        <th scope="row">T/O days</th>
                        <td>@WebUtil.NCommaRound(lastPmSummaryEx.InventoryToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPnSummaryEx.InventoryToDays, 2)</td>
                        <td>@WebUtil.NCommaRound(thisPmSummaryEx.InventoryToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.InventoryToDays - thisPnSummaryEx.InventoryToDays, 2)</td>
                        <td class="bg_blue">@WebUtil.NCommaRound(thisPmSummaryEx.InventoryToDays - lastPmSummaryEx.InventoryToDays, 2)</td>
                    </tr>
                </tbody>
            </table>

            <div class="btn_area align_left_right">
                <button class="btn full_green left" type="button" onclick="onList();">목록</button>
                @*<button class="btn full_green" type="button" onclick="onSave();">저장하기</button>*@
            </div>
        </div>
        <!--// con_box -->

    </form>

</div><!--//container-->
<script>
    function onCalculationAction() {
        var f = document.frmMain;

        // 값확인
        if (!onCheckMultipleNameDoubleValues("Assets", "총자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentAssets", "유동자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Liabilities", "총부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentLiabilities", "유동부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Capital", "총자본" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Cash", "현금" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Loan", "차입금" + "@Message.MSG_001")) return false;

        // 값확인
        if (!onCheckMultipleNameDoubleValues("AfterTaxOperationProfit", "세후 영업이익" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentAssets", "투하자본" + "@Message.MSG_001")) return false;

        // 값확인
        if (!onCheckMultipleNameDoubleValues("AnnualSales", "연간 매출액" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("AnnualSalesCost", "연간매출원가(AP)" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("InventoryCost", "연간매출원가(Inv)" + "@Message.MSG_001")) return false;


        if (!onCheckMultipleNameDoubleValues("Ar", "Ar" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Ap", "Ap" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Inventory", "Inventory" + "@Message.MSG_001")) return false;

        if (confirm("@Message.MSG_002_Q")) {
            f.message.value = "@Message.MSG_002_A";
            f.action = "Calculation_Action";
            f.submit();
        }
    }

    function onSalesAccountAction() {
        var f = document.frmMain;

        // 값확인
        if (!onCheckMultipleNameDoubleValues("Assets", "총자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentAssets", "유동자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Liabilities", "총부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentLiabilities", "유동부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Capital", "총자본" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Cash", "현금" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Loan", "차입금" + "@Message.MSG_001")) return false;

        // 값확인
        if (!onCheckMultipleNameDoubleValues("AfterTaxOperationProfit", "세후 영업이익" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentAssets", "투하자본" + "@Message.MSG_001")) return false;

        // 값확인
        if (!onCheckMultipleNameDoubleValues("AnnualSales", "연간 매출액" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("AnnualSalesCost", "연간매출원가(AP)" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("InventoryCost", "연간매출원가(Inv)" + "@Message.MSG_001")) return false;


        if (confirm("@Message.MSG_002_Q")) {
            f.message.value = "@Message.MSG_002_A";
            f.action = "SalesAccount_Action";
            f.submit();
        }
    }

    function onReset() {
        var f = document.frmMain;
        if (confirm("@Message.MSG_003_Q")) {
            f.message.value = "@Message.MSG_003_A";
            f.action = "Write";
            f.submit();
        }
    }

    function onDownExcel() {
        var f = document.frmMain;
        f.action = "Excel_Down";
        f.submit();
    }

    function onUploadExcel() {
        var f = document.frmMain;
        var excelFilePath = $("#ExcelFile").val();
        var fileLen = excelFilePath.length;
        var lastDot = excelFilePath.lastIndexOf('.');
        var excelFileExt = excelFilePath.substring(lastDot + 1, fileLen).toLowerCase();

        if (excelFileExt == "") {
            alert('업로드할 파일을 첨부하세요.');
            return;
        }

        if (excelFileExt != "xlsx") {
            alert('엑셀 파일만 업로드 가능합니다.');
            $("#ExcelFile").val('');
            return;
        }

        var formData = new FormData($("#frmMain")[0]);

        $.ajax({
            type: "post",
            url: "Excel_Upload",
            data: formData,
            processData: false,
            contentType: false,
            success: function (res) {
                if (res.success) {
                    alert('업로드되었습니다.');
                    f.action = "Write";
                    f.submit();
                }
                else {
                    $("#ExcelFile").val('');
                    alert(res.resultMsg);
                }
            },
            error: function (request, status, error) {
                alert("code:" + request.status + "\n" + "[" + request.responseText + "]");
            }
        });
    }

    function onRegistStatusChange(afterRegistStatus) {
        var f = document.frmMain;
        f.afterRegistStatus.value = afterRegistStatus;

        var confirmMessage = "";
        if (afterRegistStatus == "@(Define.REGIST_STATUS.GetKey("승인대기"))") {
            confirmMessage = "@Message.MSG_008_Q";
            f.message.value = "@Message.MSG_008_A";
        }
        else if (afterRegistStatus == "@(Define.REGIST_STATUS.GetKey("1차승인"))") {
            confirmMessage = "@Message.MSG_004_Q";
            f.message.value = "@Message.MSG_004_A";
        }
        else if (afterRegistStatus == "@(Define.REGIST_STATUS.GetKey("1차반려"))") {
            confirmMessage = "@Message.MSG_005_Q";
            f.message.value = "@Message.MSG_005_A";
        }
        else if (afterRegistStatus == "@(Define.REGIST_STATUS.GetKey("최종승인"))") {
            confirmMessage = "@Message.MSG_004_Q";
            f.message.value = "@Message.MSG_004_A";
        }
        else if (afterRegistStatus == "@(Define.REGIST_STATUS.GetKey("2차반려"))") {
            confirmMessage = "@Message.MSG_005_Q";
            f.message.value = "@Message.MSG_005_A";
        }

        if (confirm(confirmMessage)) {
            f.action = "Regist_Status_Change";
            f.submit();
        }
    }

    function onList() {
        var f = document.frmMain;
        f.action = "List";
        f.submit();
    }

    function onSave() {
        var f = document.frmMain;

        // B/Sheet
        if (!onCheckMultipleNameDoubleValues("Assets", "총자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentAssets", "유동자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Liabilities", "총부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("CurrentLiabilities", "유동부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Capital", "총자본" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Cash", "현금" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Loan", "차입금" + "@Message.MSG_001")) return false;

        // ROIC
        if (!onCheckMultipleNameDoubleValues("AfterTaxOperationProfit", "세후 영업이익" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("PainInCapital", "투하자본" + "@Message.MSG_001")) return false;

        // W/Capital
        if (!onCheckMultipleNameDoubleValues("AnnualSales", "연간 매출액" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("AnnualSalesCost", "연간매출원가(AP)" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("InventoryCost", "연간매출원가(Inv)" + "@Message.MSG_001")) return false;

        //W/Capital 등록
        if (!onCheckMultipleNameDoubleValues("Ar", "A/R" + "@Message.MSG_001")) return false;
        //if (!onCheckMultipleNameDoubleValues("ArToDays", "AR T/O Days" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Ap", "A/P" + "@Message.MSG_001")) return false;
        //if (!onCheckMultipleNameDoubleValues("ApToDays", "AP T/O Days" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("Inventory", "Inventory" + "@Message.MSG_001")) return false;
        //if (!onCheckMultipleNameDoubleValues("InventoryToDays", "Inventory T/O Days" + "@Message.MSG_001")) return false;

        if (!onCheckMultipleNameDoubleValues("SummaryAssets", "(요약)총자산" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryLiabilities", "(요약)총부채" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryCapital", "(요약)총자본" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryCash", "(요약)현금" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryLoan", "(요약)차입금" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryLiabilitiesRate", "(요약)부채비율" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryAfterTaxOperationProfit", "(요약)세후영업이익" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryPainInCapital", "(요약)투자하본" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryRoic", "(요약)ROIC" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryAr", "(요약)A/R" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryArToDays", "(요약)AR T/O Days" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryAp", "(요약)A/P" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryApToDays", "(요약)AP T/O Days" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryInventory", "(요약)Inventory" + "@Message.MSG_001")) return false;
        if (!onCheckMultipleNameDoubleValues("SummaryInventoryToDays", "(요약)Inventory T/O Days" + "@Message.MSG_001")) return false;

        //중기재무등록 추가해야함

        f.action = "Edit_Action";
        f.submit();
    }
</script>

