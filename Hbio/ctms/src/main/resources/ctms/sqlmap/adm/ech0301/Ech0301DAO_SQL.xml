<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap>
	<!-- 연구대상자(피험자관리)******************************************************************************************************************************************* -->
	<!-- 변수목록 연구대상자 SB1000M
                A.CORP_CD                     AS corpCd            회사코드
                A.RSJ_NO                      AS rsjNo             연구대상자번호
                A.RSJ_NAME                    AS rsjName           이름
                A.REG_DT                      AS regDt             등록일자
                A.BR_DT                       AS brDt              생년월일
                A.JREG_NO                     AS jregNo            주민등록번호
                A.ACCT_NO                     AS acctNo            통장번호
                A.BANK_NAME                   AS bankName          은행명칭
                A.ACCT_NAME                   AS acctName          예금주
                A.ACCT_CP                     AS acctCp            통장사본
                A.POST_NO                     AS postNo            우편번호
                A.ADDR_MAIN                   AS addrMain          기본주소
                A.ADDR_GITA                   AS addrGita          기타주소
                A.RSJ_ST_CLS                  AS rsjStCls          연구순응도상태
                F.CD_NAME                     AS rsjStClsNm        연구순응도상태명
                A.GEN_YN                      AS genYn             성별
                A.HP_NO                       AS hpNo              휴대폰번호
                A.EMAIL                       AS email             메일주소
                A.POSITION                    AS position          직급
                A.USER_ID                     AS userId            아이디
                A.PW_NO                       AS pwNo              비밀번호
                A.BRANCH_CD                   AS branchCd          지사코드
                G.BRANCH_NAME                 AS branchName        지사코드명
                A.SPOT                        AS spot              직위
                A.RLOGIN_DT                   AS rloginDt          최근로그인일시
                A.USER_ST                     AS userSt            사용자상태
                H.CD_NAME                     AS userStNm          사용자상태명
                A.REMK                        AS remk              비고
                A.EFF_STDT                    AS effStdt           유효시작일
                A.EFF_ENDT                    AS effEndt           유효종료일
                A.LOGIN_FAIL				  AS loginFail        로그인실패횟수
                A.CFM_DT                      AS cfmDt             최종확인일자
                A.CFM_DT                      AS cfmDt             최종확인일자
                A.CFM_YN                      AS cfmYn             확인여부
                A.DATA_REGDT                  AS dataRegdt         등록수정일
                A.DATA_REGNT                  AS dataRegnt         등록수정자
    -->
    <!-- 변수목록 연구대상자유형 SB1010M
                A.CORP_CD                     AS corpCd            회사코드
                A.RSJ_NO                      AS rsjNo             연구대상자번호
                F.RSJ_NAME                    AS rsjName           연구대상자번호명 
                A.FA_YN                       AS faYn              안면여드름
                A.BA_YN                       AS baYn              등여드름
                A.NF_YN                       AS nfYn              팔자주름
                A.CL_YN                       AS clYn              셀룰라이트
                A.WE_YN                       AS weYn              눈가주름
                A.DC_YN                       AS dcYn              다크서클
                A.LT_YN                       AS ltYn              광피부타입
                A.PM_YN                       AS pmYn              색소침착
                A.HL_YN                       AS hlYn              탈모
                A.EB_YN                       AS ebYn              아이백
                A.SN_YN                       AS snYn              민감여부
                A.DD_YN                       AS ddYn              비듬
                A.FL_YN                       AS flYn              홍조
                A.DATA_REGDT                  AS dataRegdt         등록수정일
                A.DATA_REGNT                  AS dataRegnt         등록수정자
    -->    
    
	<sql id="where_sb1000m">
		FROM    SB1000M A
                INNER JOIN CM4000M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.CD_CLS        = 'CT1010'
        AND     F.CD            = A.RSJ_ST_CLS          
                LEFT OUTER JOIN CT1020M G
        ON      G.CORP_CD       = A.CORP_CD
        AND     G.BRANCH_CD     = A.BRANCH_CD           
                INNER JOIN CM4000M H
        ON      H.CORP_CD       = A.CORP_CD
        AND     H.CD_CLS        = 'CM1250'
        AND     H.CD            = A.USER_ST
                INNER JOIN SB1010M I
        ON      I.CORP_CD       = A.CORP_CD
        AND     I.RSJ_NO        = A.RSJ_NO
		<dynamic prepend="WHERE">
			<isNotEmpty property="corpCd" prepend="AND">
	        	A.CORP_CD = #corpCd#
	        </isNotEmpty>
	        <isNotEmpty property="searchCondition4" prepend="">
					<isEqual property="searchCondition4" compareValue="1">
						<isNotEmpty property="searchCondition1" prepend="AND">
							<isNotEmpty property="searchCondition2" >
								REG_DT BETWEEN #searchCondition1# AND #searchCondition2#
							</isNotEmpty>
						</isNotEmpty>
					</isEqual>
					<isEqual property="searchCondition4" compareValue="2">
						<isNotEmpty property="searchCondition1" prepend="AND">
							<isNotEmpty property="searchCondition2" >
								CFM_DT BETWEEN #searchCondition1# AND #searchCondition2#
							</isNotEmpty>
						</isNotEmpty>
					</isEqual>
			</isNotEmpty>
			<isNotEmpty property="cfmYn" prepend="AND">
				<isEqual property="cfmYn" compareValue="1">
							CFM_DT IS NULL OR CFM_DT = ''
				</isEqual>
				<isEqual property="cfmYn" compareValue="2">
							CFM_DT != ''
				</isEqual>
			</isNotEmpty>
		    <isNotEmpty property="searchCondition3" prepend="AND">
	        	<!-- 전체 -->
	        	<isEqual property="searchCondition3" compareValue="1">
		        	<isNotEmpty property="searchWord" >
						(A.RSJ_NAME LIKE CONCAT ('%',#searchWord#,'%') 
						OR A.HP_NO LIKE CONCAT ('%',#searchWord#,'%')
						OR A.BR_DT LIKE CONCAT ('%',#searchWord#,'%'))
					</isNotEmpty>
				</isEqual>
				<!-- 이름 -->
	        	<isEqual property="searchCondition3" compareValue="2">
		        	<isNotEmpty property="searchWord" >
						(A.RSJ_NAME LIKE CONCAT ('%',#searchWord#,'%'))
					</isNotEmpty>
				</isEqual>
				<!-- 생년월일 -->
	        	<isEqual property="searchCondition3" compareValue="3">
		        	<isNotEmpty property="searchWord">
						(A.BR_DT LIKE CONCAT ('%',#searchWord#,'%'))
					</isNotEmpty>
				</isEqual>
				<!-- 전화번호 -->
	        	<isEqual property="searchCondition3" compareValue="4">
		        	<isNotEmpty property="searchWord">
						(A.HP_NO LIKE CONCAT ('%',#searchWord#,'%'))
					</isNotEmpty>
				</isEqual>
				<!-- 피험자번호 -->
	        	<isEqual property="searchCondition3" compareValue="5">
		        	<isNotEmpty property="searchWord">
						(A.RSJ_NO LIKE CONCAT ('%',#searchWord#,'%'))
					</isNotEmpty>
				</isEqual>
	        </isNotEmpty>
		</dynamic>
	</sql>
	
	<!-- 피험자관리 리스트 -->
	<select id="Ech0301DAO.selectEch0301List" parameterClass="searchVO"
		resultClass="egovMap">
		/* Ech0301DAO.selectEch0301List */
	<![CDATA[
		SELECT 
			a.* FROM 
			(		
				SELECT  
                A.CORP_CD                     AS corpCd            
              , A.RSJ_NO                      AS rsjNo             
              , A.RSJ_NAME                    AS rsjName           
              , A.REG_DT                      AS regDt             
              , A.BR_DT                       AS brDt
              , FLOOR(CAST(DATEDIFF(DAY,A.BR_DT,GETDATE()) AS INTEGER)/365.2422) AS age              
              , A.JREG_NO                     AS jregNo            
              , A.ACCT_NO                     AS acctNo            
              , A.BANK_NAME                   AS bankName          
              , A.ACCT_NAME                   AS acctName          
              , A.ACCT_CP                     AS acctCp            
              , A.POST_NO                     AS postNo            
              , A.ADDR_MAIN                   AS addrMain          
              , A.ADDR_GITA                   AS addrGita
              , CONCAT (A.ADDR_MAIN, A.ADDR_GITA)  AS addr          
              , A.RSJ_ST_CLS                  AS rsjStCls          
              , F.CD_NAME                     AS rsjStClsNm        
              , A.GEN_YN                      AS genYn
              , CASE A.GEN_YN
              		WHEN '1' THEN '남'
              		WHEN '2' THEN '여'
              	  	ELSE '미정'
              	END AS genName             
              , A.HP_NO                       AS hpNo              
              , A.EMAIL                       AS email             
              , A.POSITION                    AS position          
              , A.USER_ID                     AS userId            
              , A.PW_NO                       AS pwNo              
              , A.BRANCH_CD                   AS branchCd          
              , G.BRANCH_NAME                 AS branchName        
              , A.SPOT                        AS spot              
              , A.RLOGIN_DT                   AS rloginDt          
              , A.USER_ST                     AS userSt            
              , H.CD_NAME                     AS userStNm          
              , A.REMK                        AS remk              
              , A.EFF_STDT                    AS effStdt           
              , A.EFF_ENDT                    AS effEndt           
              , A.DATA_REGDT                  AS dataRegdt         
              , A.DATA_REGNT                  AS dataRegnt
              , A.CFM_DT					  AS cfmDt
              , A.CFM_YN					  AS cfmYn
              , A.LOGIN_FAIL				  AS loginFail
              , (SELECT COUNT(*) 
              		FROM RS2000M M
              		INNER JOIN RS1000M M1
              		ON M1.CORP_CD = M.CORP_CD
              		AND M1.RS_NO  = M.RS_NO
              		AND M1.DEL_YN = 'N'
					WHERE M.CORP_CD = A.CORP_CD
					AND   M.RSJ_NO = A.RSJ_NO
					AND   M.RSI_NO IS NOT NULL  		
					AND   M.RSI_NO != '') 	  AS jnCnt
					
			  , (SELECT concat('예약(',O.mtSt,')') 
	 				from (SELECT COUNT(*) as mtSt 
              				FROM RS4000M N
              				INNER JOIN RS1000M N1
              				ON N1.CORP_CD = N.CORP_CD
              				AND N1.RS_NO  = N.RS_NO
              				AND N1.DEL_YN = 'N'
							WHERE N.CORP_CD = A.CORP_CD
							AND   N.RSJ_NO = A.RSJ_NO
							AND   N.MT_ST = '10') O 
				) as tmtSt		
				]]>
		<include refid="where_sb1000m" />	
		
		<![CDATA[
				
			) A 
			ORDER BY A.rsjNo DESC
				OFFSET #firstIndex# ROWS
				FETCH NEXT #recordCountPerPage# ROWS ONLY			
		]]>	
	</select>
	
	<!--  LIMIT #firstIndex#, #recordCountPerPage# -->

	<!-- 피험자관리 엑셀 리스트 -->
	<select id="Ech0301DAO.selectEch0301Excel" parameterClass="searchVO" resultClass="egovMap">
	/* Ech0301DAO.selectEch0301Excel */
	<![CDATA[
		SELECT 
			a.* FROM 
			(		
			SELECT  
                A.CORP_CD                     AS corpCd            
              , A.RSJ_NO                      AS rsjNo             
              , A.RSJ_NAME                    AS rsjName           
              , A.REG_DT                      AS regDt             
              , A.BR_DT                       AS brDt
              , FLOOR(CAST(DATEDIFF(DAY,A.BR_DT,GETDATE()) AS INTEGER)/365.2422) AS age              
              , A.JREG_NO                     AS jregNo            
              , A.ACCT_NO                     AS acctNo            
              , A.BANK_NAME                   AS bankName          
              , A.ACCT_NAME                   AS acctName          
              , A.ACCT_CP                     AS acctCp            
              , A.POST_NO                     AS postNo            
              , A.ADDR_MAIN                   AS addrMain          
              , A.ADDR_GITA                   AS addrGita
              , CONCAT (A.ADDR_MAIN, A.ADDR_GITA)  AS addr          
              , A.RSJ_ST_CLS                  AS rsjStCls          
              , F.CD_NAME                     AS rsjStClsNm        
              , A.GEN_YN                      AS genYn
              , CASE A.GEN_YN
              		WHEN '1' THEN '남'
              		WHEN '2' THEN '여'
              	  	ELSE '미정'
              	END AS genName             
              , A.HP_NO                       AS hpNo              
              , A.EMAIL                       AS email             
              , A.POSITION                    AS position          
              , A.USER_ID                     AS userId            
              , A.PW_NO                       AS pwNo              
              , A.BRANCH_CD                   AS branchCd          
              , G.BRANCH_NAME                 AS branchName        
              , A.SPOT                        AS spot              
              , A.RLOGIN_DT                   AS rloginDt          
              , A.USER_ST                     AS userSt            
              , H.CD_NAME                     AS userStNm          
              , A.REMK                        AS remk              
              , A.EFF_STDT                    AS effStdt           
              , A.EFF_ENDT                    AS effEndt           
              , A.DATA_REGDT                  AS dataRegdt         
              , A.DATA_REGNT                  AS dataRegnt
              , A.CFM_DT					  AS cfmDt
              , A.CFM_YN					  AS cfmYn
              , A.LOGIN_FAIL				  AS loginFail
              , (SELECT COUNT(*) 
              		FROM RS2000M M
              		INNER JOIN RS1000M M1
              		ON M1.CORP_CD = M.CORP_CD
              		AND M1.RS_NO  = M.RS_NO
              		AND M1.DEL_YN = 'N'
					WHERE M.CORP_CD = A.CORP_CD
					AND   M.RSJ_NO = A.RSJ_NO
					AND   M.RSI_NO IS NOT NULL  		
					AND   M.RSI_NO != '') 	  AS jnCnt
					
			  , (SELECT concat('예약(',O.mtSt,')') 
	 				from (SELECT COUNT(*) as mtSt 
              				FROM RS4000M N
              				INNER JOIN RS1000M N1
              				ON N1.CORP_CD = N.CORP_CD
              				AND N1.RS_NO  = N.RS_NO
              				AND N1.DEL_YN = 'N'
							WHERE N.CORP_CD = A.CORP_CD
							AND   N.RSJ_NO = A.RSJ_NO
							AND   N.MT_ST = '10') O 
				) as tmtSt			
				]]>
				
		<include refid="where_sb1000m" />	
		
		<![CDATA[
				
			) a 
			ORDER BY A.rsjNo DESC
			
		]]>	
	</select>


	<!-- 피험자관리 cnt -->
	<select id="Ech0301DAO.selectEch0301ListCnt" parameterClass="searchVO"
		resultClass="int">
		/*Ech0301DAO.selectEch0301ListCnt */
	<![CDATA[
		SELECT
			count(*) totalCnt
	]]>
		<include refid="where_sb1000m" />
	</select>

	<!-- 피험자관리 상세보기 -->
	<select id="Ech0301DAO.selectEch0301View" parameterClass="sb1000mVO"
		resultClass="sb1000mVO">
		/* Ech0301DAO.selectEch0301View */
	<![CDATA[
	    SELECT  
                A.CORP_CD                     AS corpCd            
              , A.RSJ_NO                      AS rsjNo             
              , A.RSJ_NAME                    AS rsjName           
              , A.REG_DT                      AS regDt             
              , A.BR_DT                       AS brDt
              , FLOOR(CAST(DATEDIFF(DAY,A.BR_DT,GETDATE()) AS INTEGER)/365.2422) AS age              
              , A.JREG_NO                     AS jregNo            
              , A.ACCT_NO                     AS acctNo            
              , A.BANK_NAME                   AS bankName          
              , A.ACCT_NAME                   AS acctName          
              , A.ACCT_CP                     AS acctCp            
              , A.POST_NO                     AS postNo            
              , A.ADDR_MAIN                   AS addrMain          
              , A.ADDR_GITA                   AS addrGita          
              , A.RSJ_ST_CLS                  AS rsjStCls          
              , F.CD_NAME                     AS rsjStClsNm        
              , A.GEN_YN                      AS genYn
              , CASE A.GEN_YN
              		WHEN '1' THEN '남'
              		WHEN '2' THEN '여'
              	  	ELSE '미정'
              	END AS genName                   	           
              , A.HP_NO                       AS hpNo              
              , A.EMAIL                       AS email             
              , A.POSITION                    AS position          
              , A.USER_ID                     AS userId            
              , A.PW_NO                       AS pwNo              
              , A.BRANCH_CD                   AS branchCd          
              , G.BRANCH_NAME                 AS branchName        
              , A.SPOT                        AS spot              
              , A.RLOGIN_DT                   AS rloginDt          
              , A.USER_ST                     AS userSt            
              , H.CD_NAME                     AS userStNm          
              , A.REMK                        AS remk              
              , A.EFF_STDT                    AS effStdt           
              , A.EFF_ENDT                    AS effEndt           
              , A.DATA_REGDT                  AS dataRegdt         
              , A.DATA_REGNT                  AS dataRegnt
              , A.CFM_DT					  AS cfmDt
              , A.CFM_YN					  AS cfmYn
              , A.LOGIN_FAIL				  AS loginFail
        FROM    SB1000M A
                INNER JOIN CM4000M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.CD_CLS        = 'CT1010'
        AND     F.CD            = A.RSJ_ST_CLS          
                INNER JOIN CT1020M G
        ON      G.CORP_CD       = A.CORP_CD
        AND     G.BRANCH_CD     = A.BRANCH_CD           
                INNER JOIN CM4000M H
        ON      H.CORP_CD       = A.CORP_CD
        AND     H.CD_CLS        = 'CM1250'
        AND     H.CD            = A.USER_ST
                INNER JOIN SB1010M I
        ON      I.CORP_CD       = A.CORP_CD
        AND     I.RSJ_NO        = A.RSJ_NO             
        WHERE   A.CORP_CD       = #corpCd#              
        AND     A.RSJ_NO        = #rsjNo#               
        ORDER   BY
                A.CORP_CD
              , A.RSJ_NO
	]]>
	</select>
	
    <!-- 피험자관리 삭제 -->
	<delete id="Ech0301DAO.deleteEch0301" parameterClass="sb1000mVO">
		/* Ech0301DAO.deleteEch0301 */
	<![CDATA[
		DELETE
        FROM
                SB1000M
        WHERE
                CORP_CD         = #corpCd#              
              	AND RSJ_NO          = #rsjNo#               
	]]>
	</delete>
	
	<!-- 피험자관리 추가 -->
	<insert id="Ech0301DAO.insertEch0301" parameterClass="sb1000mVO">
	<selectKey keyProperty="rsjNo" resultClass="string" type="pre">
		DECLARE @R_CORP_CD                  NVARCHAR(0008) = #corpCd#                                                  
        DECLARE @V_REG_DT                   NVARCHAR(0010) = #regDt#                                                   
        DECLARE @P_RTN_KEY                  NVARCHAR(0020)                                                                 
        DECLARE @BDT04                      NVARCHAR(0004)                                                                 
        DECLARE @BDT06                      NVARCHAR(0006)                                                                 
        DECLARE @BDT10                      NVARCHAR(0010)                                                                 
        SET     @BDT10                      = CONVERT(NVARCHAR(10), GETDATE(), 23)                                         
        SET     @BDT04                      = SUBSTRING(@V_REG_DT, 1, 4)                                                   
        SET     @BDT06                      = SUBSTRING(DBO.UFN_DTG08(@BDT10), 1, 6)                                       
                                                                                                                           
        SELECT  CONVERT(NVARCHAR, CONVERT(DECIMAL(18, 0), ISNULL(MAX(A.RSJ_NO), @BDT04 + '0000')) + 1) as rsjNo      
        FROM    SB1000M A                                                                                                  
        WHERE   A.CORP_CD                   = @R_CORP_CD                                                                   
        AND     SUBSTRING(A.REG_DT, 1, 4)   = @BDT04		

	</selectKey>
	/* Ech0301DAO.insertEch0301 */
	<![CDATA[
		                                                                       
 
 
        INSERT  SB1000M(
                CORP_CD                     
              , RSJ_NO                      
              , RSJ_NAME                    
              , REG_DT                      
              , BR_DT                       
              , JREG_NO                     
              , ACCT_NO                     
              , BANK_NAME                   
              , ACCT_NAME                   
              , ACCT_CP                     
              , POST_NO                     
              , ADDR_MAIN                   
              , ADDR_GITA                   
              , RSJ_ST_CLS                  
              , GEN_YN                      
              , HP_NO                       
              , EMAIL                       
              , POSITION                    
              , USER_ID                     
              , PW_NO                       
              , BRANCH_CD                   
              , SPOT                        
              , RLOGIN_DT                   
              , USER_ST                     
              , REMK                        
              , EFF_STDT                    
              , EFF_ENDT
              , CFM_DT
              , CFM_YN
              , LOGIN_FAIL
              , DATA_REGDT                  
              , DATA_REGNT
              , REG_LV                  
        ) VALUES(
                #corpCd#
              , #rsjNo#
              , #rsjName#
              , #regDt#
              , #brDt#
              , #jregNo#
              , #acctNo#
              , #bankName#
              , #acctName#
              , #acctCp#
              , #postNo#
              , #addrMain#
              , #addrGita#
              , #rsjStCls#
              , #genYn#
              , #hpNo#
              , #email#
              , #position#
              , #userId#
              , #pwNo#
              , #branchCd#
              , #spot#
              , #rloginDt#
              , #userSt#
              , #remk#
              , #effStdt#
              , #effEndt#
              , #cfmDt#
              , #cfmYn#
              , #loginFail#
              , GETDATE()
              , #dataRegnt#
              , '1'
        )
	]]>
	</insert>

	<!-- 피험자관리 수정 -->
	<update id="Ech0301DAO.updateEch0301" parameterClass="sb1000mVO">
		/* Ech0301DAO.updateEch0301 */
	<![CDATA[
	    UPDATE
                SB1000M
        SET
              RSJ_NAME                    = #rsjName#                     
              , REG_DT                      = #regDt#                       
              , BR_DT                       = #brDt#                        
              , JREG_NO                     = #jregNo#                      
              , ACCT_NO                     = #acctNo#                      
              , BANK_NAME                   = #bankName#                    
              , ACCT_NAME                   = #acctName#                    
              , ACCT_CP                     = #acctCp#                      
              , POST_NO                     = #postNo#                      
              , ADDR_MAIN                   = #addrMain#                    
              , ADDR_GITA                   = #addrGita#                    
              , RSJ_ST_CLS                  = #rsjStCls#                    
              , GEN_YN                      = #genYn#                       
              , HP_NO                       = #hpNo#                        
              , EMAIL                       = #email#                       
              , POSITION                    = #position#
              , BRANCH_CD                   = #branchCd#                    
              , SPOT                        = #spot#
              , USER_ST                     = #userSt#                      
              , REMK                        = #remk#                        
              , EFF_STDT                    = #effStdt#                     
              , EFF_ENDT                    = #effEndt# 
              , CFM_DT					  	= #cfmDt#
              , CFM_YN					  	= #cfmYn#
              , LOGIN_FAIL				  	= #loginFail#                    
              , DATA_REGDT                  = GETDATE()                   
              , DATA_REGNT                  = #dataRegnt#                   
        WHERE
                CORP_CD         = #corpCd#              
              	AND RSJ_NO          = #rsjNo#   
	]]>
	</update>
	
	<!-- 연구대상자(피험자관리)유형 상세보기 -->
	<select id="Ech0301DAO.selectEch0301ResearchCls" parameterClass="sb1010mVO"
		resultClass="sb1010mVO">
		/* Ech0301DAO.selectEch0301ResearchCls */
	<![CDATA[
	    SELECT  
                A.CORP_CD                     AS corpCd            
              , A.RSJ_NO                      AS rsjNo             
              , F.RSJ_NAME                    AS rsjName           
              , A.FA_YN                       AS faYn              
              , A.BA_YN                       AS baYn              
              , A.NF_YN                       AS nfYn              
              , A.CL_YN                       AS clYn              
              , A.WE_YN                       AS weYn              
              , A.DC_YN                       AS dcYn              
              , A.LT_YN                       AS ltYn              
              , A.PM_YN                       AS pmYn              
              , A.HL_YN                       AS hlYn              
              , A.EB_YN                       AS ebYn              
              , A.SN_YN                       AS snYn              
              , A.DD_YN                       AS ddYn              
              , A.FL_YN                       AS flYn              
              , A.DATA_REGDT                  AS dataRegdt         
              , A.DATA_REGNT                  AS dataRegnt         
        FROM    SB1010M A
                INNER JOIN SB1000M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.RSJ_NO        = A.RSJ_NO              
        WHERE   A.CORP_CD       = #corpCd#              
        AND     A.RSJ_NO        = #rsjNo#               
	]]>
	</select>
		
	<!-- 연구대상자(피험자관리)유형 수정 -->
	<update id="Ech0301DAO.updateEch0301ResearchCls" parameterClass="sb1010mVO">
		/* Ech0301DAO.updateEch0301ResearchCls */
	<![CDATA[
	   UPDATE
                SB1010M
        SET
                CORP_CD                     = #corpCd#                      
              , RSJ_NO                      = #rsjNo#                       
              , FA_YN                       = #faYn#                        
              , BA_YN                       = #baYn#                        
              , NF_YN                       = #nfYn#                        
              , CL_YN                       = #clYn#                        
              , WE_YN                       = #weYn#                        
              , DC_YN                       = #dcYn#                        
              , LT_YN                       = #ltYn#                        
              , PM_YN                       = #pmYn#                        
              , HL_YN                       = #hlYn#                        
              , EB_YN                       = #ebYn#                        
              , SN_YN                       = #snYn#                        
              , DD_YN                       = #ddYn#                        
              , FL_YN                       = #flYn#                        
              , DATA_REGDT                  = GETDATE()                   
              , DATA_REGNT                  = #dataRegnt#                   
        WHERE
                CORP_CD         = #corpCd#              
              	AND RSJ_NO          = #rsjNo#      
	]]>
	</update>
	
	<!-- 연구대상자(피험자관리)유형 추가 -->
	<insert id="Ech0301DAO.insertEch0301ResearchCls" parameterClass="sb1010mVO">	
	/* Ech0301DAO.insertEch0301ResearchCls */
	<![CDATA[
		INSERT  SB1010M(
                CORP_CD                     
              , RSJ_NO                      
              , FA_YN                       
              , BA_YN                       
              , NF_YN                       
              , CL_YN                       
              , WE_YN                       
              , DC_YN                       
              , LT_YN                       
              , PM_YN                       
              , HL_YN                       
              , EB_YN                       
              , SN_YN                       
              , DD_YN                       
              , FL_YN                       
              , DATA_REGDT                  
              , DATA_REGNT                  
        ) VALUES(
                #corpCd#
              , #rsjNo#
              , #faYn#
              , #baYn#
              , #nfYn#
              , #clYn#
              , #weYn#
              , #dcYn#
              , #ltYn#
              , #pmYn#
              , #hlYn#
              , #ebYn#
              , #snYn#
              , #ddYn#
              , #flYn#
              , GETDATE()
              , #dataRegnt#
        )
	]]>
	</insert>
	
	<!-- 연구대상자(피험자관리) 유형 삭제 -->
	<delete id="Ech0301DAO.deleteEch0301ResearchCls" parameterClass="sb1010mVO">
		/* Ech0301DAO.deleteEch0301ResearchCls */
	<![CDATA[
		DELETE
        FROM
                SB1010M
        WHERE
                CORP_CD         = #corpCd#              
              	AND RSJ_NO          = #rsjNo#               
	]]>
	</delete>

	<sql id="where_sb1000mJnList">
		FROM RS2000M B
		INNER JOIN RS1000M A
		ON 		A.CORP_CD = B.CORP_CD 
		AND 	A.RS_NO = B.RS_NO
		AND 	A.DEL_YN = 'N'
		INNER JOIN CM4000M K
        ON      K.CORP_CD       = A.CORP_CD
        AND     K.CD_CLS        = 'CT2030'
        AND     K.CLS_CAT       = '3'
        AND     K.CD            = A.RS_NO3
        INNER JOIN CM4000M U
        ON      U.CORP_CD       = A.CORP_CD
        AND     U.CD_CLS        = 'CT2040'
        AND     U.CLS_CAT       = '3'
        AND     U.CD            = A.ITEM_CLS 
		INNER JOIN SB1000M J
        ON      J.CORP_CD       = B.CORP_CD
        AND     J.RSJ_NO     = B.RSJ_NO         
                INNER JOIN CM4000M G
        ON      G.CORP_CD       = A.CORP_CD
        AND     G.CD_CLS        = 'CT2050'
        AND     G.CLS_CAT       = '3'
        AND     G.CD            = A.RSST_CLS
                INNER JOIN CM4000M C
        ON      C.CORP_CD       = B.CORP_CD
        AND     C.CD_CLS        = 'CT2050'
        AND     C.CLS_CAT       = '3'
        AND     C.CD            = B.APPSTA_CLS
                INNER JOIN CT1020M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.BRANCH_CD     = A.BRANCH_CD
        WHERE B.CORP_CD = #corpCd#
        AND B.RSJ_NO = #rsjNo#		
	</sql>

	<!-- 연구대상자 참여 리스트 -->
	<select id="Ech0301DAO.selectEch0301JnList" parameterClass="sb1000mVO" resultClass="egovMap">
	/* Ech0301DAO.selectEch0301JnList */
	<![CDATA[
		SELECT Z.* FROM 
		(
			SELECT
				ROW_NUMBER() OVER(order by A.RS_NO ASC) rownum  
              , A.CORP_CD                     AS corpCd
              , A.RS_NO                       AS rsNo              
              , A.BRANCH_CD                   AS branchCd          
              , F.BRANCH_NAME                 AS branchNm        
              , A.RS_CD         	          AS rsCd            
              , A.REG_DT                      AS regDt             
              , A.RS_STDT                     AS rsStdt            
              , A.RS_ENDT                     AS rsEndt            
              , A.RS_PTC                      AS rsPtc          
              , A.RS_PPS    	              AS rsPps         
              , A.RS_NO3                      AS rsNo3
              , K.CD_NAME                     AS rsNo3Nm
              , A.RS_DRT                      AS rsDrt        
              , A.RS_SCNT                     AS rsScnt          
              , A.RS_MSCNT                    AS rsMscnt       
              , A.RSST_CLS                    AS rsStCls          
              , G.CD_NAME                     AS rsStClsNm        
              , A.REP_DT                      AS repDt             
              , A.VISIT_CNT                   AS visitCnt          
              , A.DUPL_YN                     AS duplYn            
              , A.RS_NAME                     AS rsName            
              , A.RS_PAY                      AS rsPay             
              , A.IRBSM_YN                    AS irbsmYn       
              , A.ITEM_CLS                    AS itemCls
              , U.CD_NAME 	                  AS itemClsNm
              , A.ITEM_NAME                   AS prodName          
              , A.DEL_YN                      AS delYn
              , B.RSJ_NO					  AS rsjNo
              , B.APP_STDT					  AS appStdt
              , B.APP_ENDT					  AS appEndt
              , B.APPSTA_CLS			      AS appstaCls
              , C.CD_NAME   			      AS appstaClsNm
              , B.APP_YN				      AS appYn
              , B.POOL_YN				      AS poolYn
              , B.FIRST_ST				      AS firstSt
              , B.CFM_YN				      AS cfmYn
              , B.ETC					      AS etc
              , J.RSJ_NAME                    AS rsjName
              , J.BR_DT                       AS brDt
              , FLOOR(CAST(DATEDIFF(DAY,J.BR_DT,GETDATE()) AS INTEGER)/365.2422) AS age   
              , J.HP_NO 					  AS hpNo
              , J.GEN_YN 					  AS genYn
              , CASE J.GEN_YN 
              		WHEN '1' THEN '남'
              		WHEN '2' THEN '여'
              		ELSE '미정'
              	END 						  AS genYnNm
              , J.EMAIL 					  AS email 
			]]>
		<include refid="where_sb1000mJnList" />	
		<![CDATA[
			) Z 
			ORDER BY Z.rsNo DESC
		]]>	
	</select>

	<!-- 연구대상자 참여 리스트 cnt -->
	<select id="Ech0301DAO.selectEch0301JnListCnt" parameterClass="searchVO" resultClass="int">
		/*Ech0301DAO.selectEch0301JnListCnt */
	<![CDATA[
		SELECT
			COUNT(*) totalCnt
	]]>
		<include refid="where_sb1000mJnList" />
	</select>

	<!-- 연구과제-연구대상자별 예약 목록 -->
	<select id="Ech0301DAO.selectEch0301MtList" parameterClass="sb1000mVO" resultClass="egovMap">
	/* Ech0301DAO.selectEch0301MtList */
	<![CDATA[
 		SELECT  
 			ROW_NUMBER() OVER(order by A.RESR_NO ASC) rownum
			  , A.CORP_CD					  AS corpCd	                     
              , A.RESR_NO                     AS resrNo            
              , A.REG_DT                      AS regDt             
              , A.MT_ST                       AS mtSt              
              , F.CD_NAME                     AS mtStNm            
              , A.RESR_DT                     AS resrDt            
              , A.RESR_HR                     AS resrHr            
              , A.RESR_MM                     AS resrMm            
              , A.RSJ_NO                      AS rsjNo
              , A.RS_NO						  AS rsNo
              , B.RS_CD						  AS rsCd
              , B.RS_NAME 					  AS rsName	
              , B.RS_STDT 					  As rsStdt
              , B.RS_ENDT 					  As rsEndt 
        FROM    RS4000M A
        INNER 	JOIN RS1000M B
		ON 		B.CORP_CD 		= A.CORP_CD 
		AND 	B.RS_NO 		= A.RS_NO
		AND 	B.DEL_YN 		= 'N'
                INNER JOIN CM4000M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.CD_CLS        = 'CT1030'
        AND     F.CLS_CAT       = '3'
        AND     F.CD            = A.MT_ST              
        WHERE   A.CORP_CD       = #corpCd#
        AND 	A.RSJ_NO		= #rsjNo#            
        ORDER   BY
                A.CORP_CD
              , A.RESR_NO
    ]]>          
	</select>
	
	<!-- 연구대상자 관리자확인일자 일괄등록 -->
	<update id="Ech0301DAO.updateEch0301AjaxSaveCfmDt" parameterClass="egovMap">
	/* Ech0301DAO.updateEch0301AjaxSaveCfmDt */
	UPDATE
			SB1000M
		SET
			CFM_DT = #step1#
			, CFM_YN = 'Y'
			, LOGIN_FAIL = 0
			, USER_ST = '1' 
			, DATA_REGDT = GETDATE()
			, DATA_REGNT = #step2#
		WHERE
			CORP_CD = #corpCd#
			AND RSJ_NO IN (
							SELECT
								RSJ_NO
							FROM
								SB1000M
							WHERE
								CORP_CD = #corpCd#
								AND (CFM_DT IS NULL OR CFM_DT = '')
								AND RSJ_NO 	
								<iterate open="(" close=")" conjunction="," prepend="IN" property="rsjSeq">
									#rsjSeq[]#
								</iterate>	
							)														
	</update>
	
	<!-- 연구대상자 비밀번호 재설정 -->
	<update id="Ech0301DAO.updateEch0301AjaxProfClearPw" parameterClass="sb1000mVO">
		/* Ech0301DAO.updateEch0301AjaxProfClearPw */
		UPDATE
			SB1000M
		SET
			PW_NO = #pwNo#
		WHERE
			CORP_CD = #corpCd#
		 	AND USER_ID = #userId#
	</update>
	
	<!-- 연구대상자 로그인횟수 초기화 -->
	<update id="Ech0301DAO.updateEch0301AjaxClearLgnFail" parameterClass="egovMap">
	/* Ech0301DAO.updateEch0301AjaxClearLgnFail */
	<![CDATA[
		UPDATE
			SB1000M
		SET
			LOGIN_FAIL = '0'
		WHERE
			CORP_CD = #corpCd# 
			AND USER_ID = #adminId#
	]]>
	</update>
	
	<!-- 연구대상자 아이디일괄 설정  -->
	<update id="Ech0301DAO.updateEch0301AjaxSaveFirst" parameterClass="sb1000mVO">
	/* Ech0301DAO.updateEch0301AjaxSaveFirst */
	UPDATE
			SB1000M
		SET
			USER_ID			= #userId#
			, PW_NO			= #pwNo#
			, DATA_REGDT 	= GETDATE()
			, DATA_REGNT 	= #dataRegnt#
		WHERE
			CORP_CD 	= #corpCd#
			AND RSJ_NO  = #rsjNo#
			AND (USER_ID IS NULL OR USER_ID = '')	
	</update>
	
	
	<select id="Ech0301DAO.selectEch0301GetId" parameterClass="map" resultClass="String">
		/*Ech0301DAO.selectEch0301JnListCnt */
	<![CDATA[
	    SELECT  CONCAT(#rsNo1#,CONVERT(NVARCHAR, CONVERT(DECIMAL(18, 0), ISNULL(MAX(SUBSTRING(A.USER_ID ,4,8)), '2021' + '0000')) + 1))  as userId      
        FROM    SB1000M A                                                                                                  
        WHERE   A.CORP_CD                   = #corpCd#                                                                   
        AND     SUBSTRING(A.REG_DT, 1, 4)   = #regDtY#
        AND     SUBSTRING(A.USER_ID, 1, 3)   = #rsNo1#
	]]>
	</select>
	
	<!--연구대상자로 사용된 경우 삭제 불가-->
	<select id="Ech0301DAO.select0301ChkDelCnt" parameterClass="egovMap" resultClass="int">
	/* Ech0301AO.select0301ChkDelCnt */
	<![CDATA[
		SELECT
			COUNT(*)
		FROM
			RS2000M
		WHERE
			CORP_CD = #corpCd#
			AND RSJ_NO = #rsjNo#
	]]>
	</select>
	
	<!-- SMS발송대상자 리스트 -->
	<select id="Ech0301DAO.selectEch0301SendList" parameterClass="egovMap" resultClass="egovMap">
		/* Ech0301DAO.selectEch0301SendList */
		SELECT 
			a.* FROM 
			(		
				SELECT
				ROW_NUMBER() OVER(order by A.RSJ_NO DESC) rownum  	  
              , A.CORP_CD                     AS corpCd            
              , A.RSJ_NO                      AS rsjNo             
              , A.RSJ_NAME                    AS rsjName           
              , A.REG_DT                      AS regDt             
              , A.BR_DT                       AS brDt
              , FLOOR(CAST(DATEDIFF(DAY,A.BR_DT,GETDATE()) AS INTEGER)/365.2422) AS age              
              , A.JREG_NO                     AS jregNo            
              , A.ACCT_NO                     AS acctNo            
              , A.BANK_NAME                   AS bankName          
              , A.ACCT_NAME                   AS acctName          
              , A.ACCT_CP                     AS acctCp            
              , A.POST_NO                     AS postNo            
              , A.ADDR_MAIN                   AS addrMain          
              , A.ADDR_GITA                   AS addrGita
              , CONCAT (A.ADDR_MAIN, A.ADDR_GITA)  AS addr          
              , A.RSJ_ST_CLS                  AS rsjStCls          
              , F.CD_NAME                     AS rsjStClsNm        
              , A.GEN_YN                      AS genYn
              , CASE A.GEN_YN
              		WHEN '1' THEN '남'
              		WHEN '2' THEN '여'
              	  	ELSE '미정'
              	END AS genYnNm             
              , A.HP_NO                       AS hpNo              
              , A.EMAIL                       AS email             
              , A.POSITION                    AS position          
              , A.USER_ID                     AS userId            
              , A.PW_NO                       AS pwNo              
              , A.BRANCH_CD                   AS branchCd          
              , G.BRANCH_NAME                 AS branchName        
              , A.SPOT                        AS spot              
              , A.RLOGIN_DT                   AS rloginDt          
              , A.USER_ST                     AS userSt            
              , H.CD_NAME                     AS userStNm          
              , A.REMK                        AS remk              
              , A.EFF_STDT                    AS effStdt           
              , A.EFF_ENDT                    AS effEndt           
              , A.DATA_REGDT                  AS dataRegdt         
              , A.DATA_REGNT                  AS dataRegnt
              , A.CFM_DT					  AS cfmDt
              FROM    SB1000M A
                INNER JOIN CM4000M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.CD_CLS        = 'CT1010'
        AND     F.CD            = A.RSJ_ST_CLS          
                LEFT OUTER JOIN CT1020M G
        ON      G.CORP_CD       = A.CORP_CD
        AND     G.BRANCH_CD     = A.BRANCH_CD           
                INNER JOIN CM4000M H
        ON      H.CORP_CD       = A.CORP_CD
        AND     H.CD_CLS        = 'CM1250'
        AND     H.CD            = A.USER_ST
        WHERE A.CORP_CD = #corpCd#
        AND A.RSJ_NO 	
					<iterate open="(" close=")" conjunction="," prepend="IN" property="rsjSeq">
						#rsjSeq[]#
					</iterate>
               		
			) A 
			ORDER BY A.rsjNo DESC
	</select>
	
	<!--  연구과제 상세보기 -->
    <select id="Ech0301DAO.selectEch0301RsView" parameterClass="rs1000mVO" resultClass="rs1000mVO">
    /* Ech0301DAO.selectEch0301RsView */
    <![CDATA[
        SELECT  
                A.CORP_CD                     AS corpCd            
              , A.RS_NO                       AS rsNo              
              , A.RS_NO1                      AS rsNo1             
              , A.RS_NO2                      AS rsNo2             
              , F.CD_NAME                     AS rsNo2Nm           
              , A.RS_NO3                      AS rsNo3             
              , G.CD_NAME                     AS rsNo3Nm           
              , A.RS_NO4                      AS rsNo4             
              , H.CD_NAME                     AS rsNo4Nm           
              , A.RS_NO5                      AS rsNo5             
              , A.RS_NO6                      AS rsNo6             
              , A.RS_NO7                      AS rsNo7             
              , A.RS_CD                       AS rsCd              
              , A.REG_DT                      AS regDt             
              , A.RS_DRT                      AS rsDrt             
              , I.EMP_NAME                    AS rsDrtNm            
              , A.RS_SCNT                     AS rsScnt            
              , A.RS_MSCNT                    AS rsMscnt           
              , A.RS_STDT                     AS rsStdt            
              , A.RS_ENDT                     AS rsEndt            
              , A.RSST_CLS                    AS rsstCls           
              , J.CD_NAME                     AS rsstClsNm         
              , A.REP_DT                      AS repDt             
              , A.VISIT_CNT                   AS visitCnt          
              , A.DUPL_YN                     AS duplYn            
              , A.RS_POS                      AS rsPos             
              , A.RS_NAME                     AS rsName            
              , A.RS_PPS                      AS rsPps             
              , A.RS_PTC                      AS rsPtc             
              , A.VEND_NO                     AS vendNo            
              , ISNULL(K.VEND_NAME, '')       AS vendName          
              , A.VMNG_NAME                   AS vmngName          
              , A.VMNGHP_NO                   AS vmnghpNo          
              , A.VMNG_EMAIL                  AS vmngEmail         
              , A.RS_PAY                      AS rsPay             
              , A.RS_PAYVT                    AS rsPayvt           
              , A.IRBSM_YN                    AS irbsmYn           
              , A.ITEM_CLS                    AS itemCls           
              , L.CD_NAME                     AS itemClsNm         
              , A.ITEM_NAME                   AS itemName          
              , A.BRANCH_CD                   AS branchCd          
              , A.DEL_YN                      AS delYn             
              , A.DATA_LOCK_YN                AS dataLockYn
              , A.ECRF_STATE  	              AS ecrfState
              , A.DATA_REGDT                  AS dataRegdt         
              , A.DATA_REGNT                  AS dataRegnt         
        FROM    RS1000M A
                INNER JOIN CM4000M F
        ON      F.CORP_CD       = A.CORP_CD
        AND     F.CD_CLS        = 'CT2020'
        AND     F.CLS_CAT       = '3'
        AND     F.CD            = A.RS_NO2              
                INNER JOIN CM4000M G
        ON      G.CORP_CD       = A.CORP_CD
        AND     G.CD_CLS        = 'CT2030'
        AND     G.CLS_CAT       = '3'
        AND     G.CD            = A.RS_NO3              
                INNER JOIN CM4000M H
        ON      H.CORP_CD       = A.CORP_CD
        AND     H.CD_CLS        = 'CT2060'
        AND     H.CLS_CAT       = '3'
        AND     H.CD            = A.RS_NO4              
                INNER JOIN CT1030M I
        ON      I.CORP_CD       = A.CORP_CD
        AND     I.EMP_NO        = A.RS_DRT              
                INNER JOIN CM4000M J
        ON      J.CORP_CD       = A.CORP_CD
        AND     J.CD_CLS        = 'CT2050'
        AND     J.CLS_CAT       = '3'
        AND     J.CD            = A.RSST_CLS            
                LEFT JOIN CT2000M K
        ON      K.CORP_CD       = A.CORP_CD
        AND     K.VEND_NO       = A.VEND_NO             
                INNER JOIN CM4000M L
        ON      L.CORP_CD       = A.CORP_CD
        AND     L.CD_CLS        = 'CT2040'
        AND     L.CLS_CAT       = '3'
        AND     L.CD            = A.ITEM_CLS            
        WHERE   A.CORP_CD       = #corpCd#              
        AND     A.RS_CD         = #rsCd#                
        AND     A.DEL_YN        = 'N'
    ]]>
    </select>
	
	<!-- 연구대상자 피험자선정여부 확인 -->
    <select id="Ech0301DAO.selectEch0301RsjCnt" parameterClass="egovMap" resultClass="int">
	/* Ech0301DAO.selectEch0301RsjCnt */
	<![CDATA[
		SELECT
			COUNT(*)
		FROM
			RS2000M
		WHERE
			CORP_CD 	= #corpCd#
		AND RS_NO 		= #rsNo#
		AND RSJ_NO 		= #rsjNo#	
	]]>
	</select>
	
		<!-- 연구대상자선정 추가 -->
    <insert id="Ech0301DAO.insertEch0301Sub" parameterClass="rs2000mVO">	
	/* Ech0301DAO.insertEch0301Sub */
    <![CDATA[
        DECLARE @R_CORP_CD                  NVARCHAR(0008) = #corpCd#                                                      
        DECLARE @V_RS_NO                    NVARCHAR(0010) = #rsNo#                                                        
        DECLARE @P_RTN_KEY                  INT            = 0                                                             
        DECLARE @BDT04                      NVARCHAR(0004)                                                                 
        DECLARE @BDT06                      NVARCHAR(0006)                                                                 
        DECLARE @BDT10                      NVARCHAR(0010)                                                                 
        SET     @BDT10                      = CONVERT(NVARCHAR(10), GETDATE(), 23)                                         
        SET     @BDT04                      = SUBSTRING(DBO.UFN_DTG08(@BDT10), 1, 4)                                       
        SET     @BDT06                      = SUBSTRING(DBO.UFN_DTG08(@BDT10), 1, 6)                                       
                                                                                                                           
        SELECT  @P_RTN_KEY = CONVERT(NVARCHAR, CONVERT(DECIMAL(18, 0), ISNULL(MAX(A.SUB_NO), 0)) + 1)                      
        FROM    RS2000M A                                                                                                  
        WHERE   A.CORP_CD                   = @R_CORP_CD                                                                   
        AND     A.RS_NO                     = @V_RS_NO                                                                     
 
 
        INSERT  RS2000M(
                CORP_CD                     
              , RS_NO                       
              , SUB_NO                      
              , RSI_NO1                     
              , RSI_NO2                     
              , RSI_NO3                     
              , RSI_NO                      
              , RSJ_NO                      
              , APPSTA_CLS                  
              , APP_STDT                    
              , APP_ENDT                    
              , ETC                         
              , APP_YN                      
              , POOL_YN                     
              , FIRST_ST                    
              , CFM_YN              
              , DATA_REGDT                  
              , DATA_REGNT
              , FIRST_ST_NO        
        ) VALUES(
                #corpCd#
              , #rsNo#
              , @P_RTN_KEY
              , #rsiNo1#
              , #rsiNo2#
              , #rsiNo3#
              , #rsiNo#
              , #rsjNo#
              , #appstaCls#
              , #appStdt#
              , #appEndt#
              , #etc#
              , #appYn#
              , #poolYn#
              , #firstSt#
              , #cfmYn#
              , GETDATE()
              , #dataRegnt#
              , #firstStNo#
        )
    ]]>
    </insert>
   
	<!-- 연구대상자 정보 등록단계 수정 -->
	<update id="Ech0301DAO.updateEch0301RegLv" parameterClass="sb1000mVO">
		/* Ech0301DAO.updateEch0301RegLv */
	<![CDATA[
	    UPDATE
                SB1000M
        SET
              REG_LV	        = #regLv#                     
              , DATA_REGDT      = GETDATE()                   
              , DATA_REGNT      = #dataRegnt#                   
        WHERE
                CORP_CD			= #corpCd#              
              	AND RSJ_NO		= #rsjNo#   
	]]>
	</update>
	
	<!-- 핸드폰번호 중복확인 -->
    <select id="Ech0301DAO.selectEch0301AjaxHpNoCheck" parameterClass="egovMap" resultClass="int">
	/* Ech0101DAO.selectEch0301AjaxHpNoCheck */
	<![CDATA[
		SELECT
			COUNT(*)
		FROM
			SB1000M
		WHERE
			CORP_CD = #corpCd#
		AND HP_NO = #mobile#
			
	]]>
	</select>
    
			
	<!-- /피험자관리****************************************************************************************************************************************** -->

</sqlMap>